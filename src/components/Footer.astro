---
/**
 * Footer.astro
 *
 * Componente de pie de página completo del sitio Ignia Cloud.
 *
 * ESTRUCTURA:
 * 1. Logo: Ignia Cloud branding
 * 2. SitemapFooter: Mini-sitemap dinámico con todas las rutas organizadas
 *    + Formulario de contacto integrado (6ta columna del grid)
 * 3. Copyright: Información legal
 *
 * FUNCIONALIDAD:
 * - SitemapFooter se alimenta dinámicamente de routes.* en i18n JSON
 * - ContactForm integrado en SitemapFooter con anti-bot (Turnstile + honeypot)
 *   y persistencia localStorage (30 días)
 * - Traducciones centralizadas (footer.* en src/i18n/)
 * - Multi-idioma con detección automática de Astro.currentLocale
 *
 * CUMPLIMIENTO arquitecture.md:
 * - §2: Progressive enhancement (ContactForm funciona sin JS básico)
 * - §5: Traducciones centralizadas en i18n JSON
 * - §7: Footer sticky mencionado en arquitectura
 * - §9: HTML5 semántico (<footer role="contentinfo">)
 *
 * @see src/components/SitemapFooter.astro - Componente de sitemap dinámico + formulario
 * @see src/scripts/contact-form.ts - Lógica cliente (validación, localStorage)
 * @see src/i18n/en.json - Traducciones footer.* (EN)
 * @see src/i18n/es.json - Traducciones footer.* (ES)
 * @see src/i18n/fr.json - Traducciones footer.* (FR)
 */
import "../styles/global.css";
import { useTranslations } from "@/utils/i18n";
import SitemapFooter from "./SitemapFooter.astro";

// Obtener el locale actual desde Astro (normalizado)
const rawLocale = Astro.currentLocale || "en";
const locale = rawLocale.split("-")[0];
const t = await useTranslations(locale);
---

<footer
  class="mt-auto w-full min-h-[250px] bg-[var(--color-secondary)]"
  role="contentinfo"
  aria-labelledby="footer-heading"
>
  <!-- 
    Logo del footer: Below-the-fold → loading="lazy" para optimizar LCP
    Cumplimiento arquitecture.md §10: lazy loading solo en imágenes que requieren scroll
  -->
  <img
    src="/Ignia-blanco.svg"
    alt="Ignia Cloud Logo"
    class="h-36 mx-auto pt-8 mb-4"
    loading="lazy"
    decoding="async"
    width="200"
    height="96"
  />

  <!-- 
    SITEMAP FOOTER (INTEGRADO)
    
    Componente de mini-sitemap dinámico que genera automáticamente
    un mapa visual de todas las rutas del sitio organizadas por secciones.
    
    NOTA: El formulario de contacto ahora está INTEGRADO dentro del SitemapFooter
    como la 6ta columna del grid. Esto resuelve dos problemas:
    
    1. TRADUCCIONES: Al estar en el mismo componente que el sitemap, 
       las traducciones se resuelven correctamente usando translate()
    2. INTEGRACIÓN VISUAL: El formulario es parte natural del grid,
       no un componente separado que rompe el flujo visual
    
    BENEFICIOS:
    1. Mejorar SEO con enlaces internos estructurados
    2. Facilitar navegación (usuarios encuentran contenido fácilmente)
    3. Reducir bounce rate con acceso rápido a todas las secciones
    4. Incluye nueva sección "Corporativo" con 6 enlaces institucionales
    5. Formulario de contacto como miniforma discreta integrada
    
    El componente es completamente autónomo y se actualiza automáticamente
    al agregar nuevas rutas en src/i18n/*.json (zero maintenance).
  -->
  <SitemapFooter />

  <nav class="flex justify-center space-x-6 mb-6" aria-label="Footer">
    <h2 id="footer-heading" class="sr-only">Footer</h2>
  </nav>

  <!-- Copyright -->
  <p class="text-center text-white text-sm mb-4">
    {t("footer.legal.copyright", { locale })}
  </p>
</footer>
