---
/**
 * Header.astro
 * 
 * Componente principal de navegación del sitio Ignia Cloud.
 * Refactorizado para cumplir con arquitecture.md §2 (JS mínimo o nulo).
 * 
 * Funcionalidad:
 * - Mega-menu desktop con CSS puro (:hover, :focus-within)
 * - Mobile menu nativo sin JS bloqueante
 * - Progressive enhancement con script diferido (~30 líneas)
 * 
 * Performance:
 * - Eliminado: 250 líneas de JS bloqueante
 * - LCP esperado: -200-400ms
 * - INP esperado: -50-100ms
 * 
 * @see src/styles/global.css - Estilos CSS-only que manejan la funcionalidad core
 * @see src/scripts/header-progressive.ts - Script diferido para UX enhancements
 */

// LangSelect: Selector de idioma usado en menús desktop y mobile
import LangSelect from "./langSelect.astro";
// SearchBox: Proporciona modal de búsqueda estilo command-palette
import SearchBox from "./SearchBox.astro";
import { useTranslations } from '@/utils/i18n';

// Normalizar el locale de Astro para que todos los helpers usen un valor consistente.
// Split en '-' para manejar variantes regionales (es-MX → es, fr-CA → fr)
const rawLocale = Astro.currentLocale || "es";
const locale = rawLocale.split("-")[0];

// Función helper para traducir con locale específico
const t = await useTranslations(locale);
const translate = (key: string) => t(key, { locale });

// Prefijo de rutas internas según locale (inglés sin prefijo, otros con /{locale}/)
const ensureLocalePath = (href: string) => {
  if (!href.startsWith("/")) return href;
  const trimmed = href.replace(/^\/+/u, "");
  if (locale === "en") {
    return `/${trimmed}`;
  }
  return `/${locale}/${trimmed}`;
};

type NavItem = {
  href: string;
  title: string;
  description: string;
  icon?: string; // SVG path para icono del item
};

type NavSection = {
  id: string;
  href: string;
  label: string;
  summary: string;
  items: NavItem[];
};

type NavItemConfig = {
  key: string;
  href: string;
  icon?: string; // SVG path para icono del item
};

type NavSectionConfig = {
  id: string;
  href: string;
  items: NavItemConfig[];
};

// Mapeo de iconos SVG para items del mega-menu
// Iconos de Heroicons v2 (MIT License) - stroke-width: 2, 24x24 viewBox
const itemIcons: Record<string, string> = {
  // SOLUTIONS (8 iconos)
  nocaas: 'M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9',
  privateCloudService: 'M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z',
  privateCloudOnPremise: 'M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01',
  bcpDraas: 'M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15',
  kubernetesDevops: 'M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z',
  complianceCloud: 'M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4',
  regulatoryBackupArchival: 'M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4',
  // PRODUCTS (8 iconos)
  virtualMachines: 'M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z',
  kubernetesService: 'M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01',
  blockStorage: 'M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4',
  objectStorage: 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z',
  cloudBackup: 'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z',
  cloudFirewall: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',
  dns: 'M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9',
  loadBalancer: 'M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3',
    mdm: 'M16 12a4 4 0 01-8 0V8a4 4 0 018 0v4zm-8 0v4a4 4 0 008 0v-4',
    monitoring: 'M12 20c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-14v2m0 8v2m-4-4h2m8 0h-2',
    patchManager: 'M4 17v-2a4 4 0 014-4h8a4 4 0 014 4v2M4 17h16M4 17v2a4 4 0 004 4h8a4 4 0 004-4v-2',
  // AI & LLMs (4 iconos)
  llmHosting: 'M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z',
  ragBlueprints: 'M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z',
  copilotStudio: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z',
  mlopsMonitoring: 'M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z',
  // SERVICES (3 iconos)
  managedIt: 'M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4',
  cloudConsulting: 'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z',
  supportCenter: 'M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',
};

// Definición del mega-menú para experiencia desktop; cada sección es una columna hoverable.
// NOTA: Las rutas se obtienen desde i18n (arquitecture.md §5 - Centralización Obligatoria)
// Esto permite mantener URLs localizadas por idioma sin hardcodear rutas en el código.
const navConfig: NavSectionConfig[] = [
  {
    id: 'solutions',
    href: translate('routes.solutions.base'),
    items: [
      { key: 'nocaas', href: translate('routes.solutions.nocaas'), icon: itemIcons.nocaas },
      { key: 'privateCloudService', href: translate('routes.solutions.privateCloudService'), icon: itemIcons.privateCloudService },
      { key: 'privateCloudOnPremise', href: translate('routes.solutions.privateCloudOnPremise'), icon: itemIcons.privateCloudOnPremise },
      { key: 'bcpDraas', href: translate('routes.solutions.bcpDraas'), icon: itemIcons.bcpDraas },
      { key: 'kubernetesDevops', href: translate('routes.solutions.kubernetesDevops'), icon: itemIcons.kubernetesDevops },
      { key: 'complianceCloud', href: translate('routes.solutions.complianceCloud'), icon: itemIcons.complianceCloud },
      { key: 'regulatoryBackupArchival', href: translate('routes.solutions.regulatoryBackupArchival'), icon: itemIcons.regulatoryBackupArchival },
    ],
  },
  {
    id: 'products',
    href: translate('routes.products.base'),
    items: [
      { key: 'virtualMachines', href: translate('routes.products.virtualMachines'), icon: itemIcons.virtualMachines },
      { key: 'kubernetesService', href: translate('routes.products.kubernetesService'), icon: itemIcons.kubernetesService },
      { key: 'blockStorage', href: translate('routes.products.blockStorage'), icon: itemIcons.blockStorage },
      { key: 'objectStorage', href: translate('routes.products.objectStorage'), icon: itemIcons.objectStorage },
      { key: 'cloudBackup', href: translate('routes.products.cloudBackup'), icon: itemIcons.cloudBackup },
      { key: 'cloudFirewall', href: translate('routes.products.cloudFirewall'), icon: itemIcons.cloudFirewall },
      { key: 'dns', href: translate('routes.products.dns'), icon: itemIcons.dns },
      { key: 'loadBalancer', href: translate('routes.products.loadBalancer'), icon: itemIcons.loadBalancer },
        { key: 'mdm', href: translate('routes.products.mdm'), icon: itemIcons.mdm },
        { key: 'monitoring', href: translate('routes.products.monitoring'), icon: itemIcons.monitoring },
        { key: 'patchManager', href: translate('routes.products.patchManager'), icon: itemIcons.patchManager },
    ],
  },
  {
    id: 'ai',
    href: translate('routes.ai.base'),
    items: [
      { key: 'llmHosting', href: translate('routes.ai.llmHosting'), icon: itemIcons.llmHosting },
      { key: 'ragBlueprints', href: translate('routes.ai.ragBlueprints'), icon: itemIcons.ragBlueprints },
      { key: 'copilotStudio', href: translate('routes.ai.copilotStudio'), icon: itemIcons.copilotStudio },
      { key: 'mlopsMonitoring', href: translate('routes.ai.mlopsMonitoring'), icon: itemIcons.mlopsMonitoring },
    ],
  },
  {
    id: 'services',
    href: translate('routes.services.base'),
    items: [
      { key: 'managedIt', href: translate('routes.services.managedIt'), icon: itemIcons.managedIt },
      { key: 'cloudConsulting', href: translate('routes.services.cloudConsulting'), icon: itemIcons.cloudConsulting },
      { key: 'supportCenter', href: translate('routes.services.supportCenter'), icon: itemIcons.supportCenter },
    ],
  },
];

const navSections: NavSection[] = navConfig.map((section) => ({
  id: section.id,
  href: section.href,
  label: translate(`header.sections.${section.id}.label`),
  summary: translate(`header.sections.${section.id}.summary`),
  items: section.items.map((item) => ({
    href: item.href,
    title: translate(`header.sections.${section.id}.items.${item.key}.title`),
    description: translate(`header.sections.${section.id}.items.${item.key}.description`),
    icon: item.icon, // Pasar el SVG path al NavItem
  })),
}));

// ARIA labels obtenidos desde traducciones i18n
const navAriaLabel = translate('header.nav.aria.desktop');
const mobileAriaLabel = translate('header.nav.aria.mobile');
const toggleMenuLabel = translate('header.nav.toggle');

type MobileLink = {
  href: string;
  label: string;
};

// Menú mobile usa lista plana de destinos principales más páginas clave de utilidad.
// NOTA: Rutas centralizadas desde i18n para consistencia multi-idioma
const mobileLinks: MobileLink[] = [
  ...navSections.map((section) => ({
    href: ensureLocalePath(section.href),
    label: section.label,
  })),
  {
    href: ensureLocalePath(translate('routes.common.contact')),
    label: translate('header.nav.mobile.contact'),
  },
];

// Helper usado por el template al crear enlaces a páginas específicas de locale
const localeHref = (href: string) => ensureLocalePath(href);
const logoAlt = translate('header.logo_alt');
const socialAriaLabel = translate('header.nav.aria.social');
const socialLabels = {
  linkedin: translate('header.nav.social.linkedin'),
  whatsapp: translate('header.nav.social.whatsapp'),
};
---

<!-- Header: navegación principal del sitio con enlaces localizados; Tailwind gestiona espaciado, blur y sombras -->
 <!-- el header tiene sombra color #f36b1c -->
<header
  id="main-header"
  class="sticky top-0 z-50 w-full border-b border-slate-100 bg-white/85 shadow-md shadow-[#f36b1c] backdrop-blur supports-[backdrop-filter]:bg-white/70 transition-all duration-300"
>
  <!-- Wrapper: alinea logo, navegación desktop y acciones de utilidad -->
  <div class="mx-auto flex max-w-7xl flex-col px-4 py-4 sm:px-6 lg:px-8 transition-all duration-300 data-[scrolled=true]:py-2" id="header-wrapper">
    <div class="flex items-center justify-between gap-4 lg:gap-6">
      <!-- Logo del sitio: enlace a home page con locale detectado -->
      <a
        href={locale === "en" ? "/" : `/${locale}/`}
        class="block shrink-0"
        aria-label={logoAlt}
      >
        <!-- 
          Logo como LCP candidate: 
          - fetchpriority="high" para priorizar carga
          - Sin loading="lazy" (está above the fold)
          - decoding="async" para no bloquear rendering
          
          Cumplimiento arquitecture.md §14: LCP < 2.5s
        -->
        <img
          src="/logo.svg"
          alt={logoAlt}
          class="h-12 w-auto transition-all duration-300 data-[scrolled=true]:h-9"
          fetchpriority="high"
          decoding="async"
          id="header-logo"
        />
      </a>
      <!-- Desktop mega-menu: only visible from extra-large breakpoints (≥1280px) -->
      <div class="hidden flex-1 items-center justify-center xl:flex">
        <nav class="nav-ignia" aria-label={navAriaLabel}>
          <ul class="nav-ignia__list">
            {
              navSections.map((section) => (
                <li class="nav-ignia__item">
                  <!-- Trigger: funciona con :hover y :focus-within (CSS puro) -->
                  <button
                    type="button"
                    class="nav-ignia__trigger"
                    aria-haspopup="true"
                    aria-expanded="false"
                    aria-label={section.label}
                  >
                    {section.label}
                    <svg
                      class="nav-ignia__trigger-icon"
                      viewBox="0 0 16 16"
                      aria-hidden="true"
                    >
                      <path
                        d="M3.22 5.22a.75.75 0 0 1 1.06 0L8 8.94l3.72-3.72a.75.75 0 0 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L3.22 6.28a.75.75 0 0 1 0-1.06z"
                        fill="currentColor"
                      />
                    </svg>
                  </button>
                  <!-- Panel mega: se muestra con CSS :hover y :focus-within del li padre -->
                  <div class="nav-ignia__panel">
                    <div class="nav-ignia__summary">
                      <h3 class="nav-ignia__summary-title">
                        {section.label}
                      </h3>
                      <p class="nav-ignia__summary-text">
                        {section.summary}
                      </p>
                      <a
                        href={localeHref(section.href)}
                        class="nav-ignia__summary-link"
                      >
                        {translate('header.sections.explore_all')}
                      </a>
                    </div>
                    <ul class="nav-ignia__panel-list">
                      {section.items.map((item) => (
                        <li class="nav-ignia__panel-item">
                          <a
                            href={localeHref(item.href)}
                            class="nav-ignia__panel-link group"
                          >
                            <div class="flex items-start gap-3">
                              {/* Icono SVG del item (16x16px) */}
                              {item.icon && (
                                <svg
                                  class="h-4 w-4 mt-0.5 shrink-0 text-slate-400 transition-colors group-hover:text-orange-500"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                  aria-hidden="true"
                                >
                                  <path d={item.icon} />
                                </svg>
                              )}
                              {/* Contenido del enlace */}
                              <div class="flex-1">
                                <span class="nav-ignia__panel-title">
                                  {item.title}
                                </span>
                                <span class="nav-ignia__panel-description">
                                  {item.description}
                                </span>
                              </div>
                            </div>
                          </a>
                        </li>
                      ))}
                    </ul>
                  </div>
                </li>
              ))
            }
          </ul>
        </nav>
      </div>
      <!-- Utility bar: search shortcut, language selector, and social icons -->
      <div class="flex items-center gap-2 lg:gap-3 flex-shrink-0">
        <!-- Desktop search shortcut: hidden on small screens -->
        <div class="hidden w-56 lg:block lg:flex-shrink-0">
          <SearchBox />
        </div>
        <!-- Desktop language selector: mobile version lives inside the flyout -->
        <div class="hidden lg:block lg:flex-shrink-0">
          <LangSelect />
        </div>
        <!-- Social icons: persistent access to LinkedIn and WhatsApp -->
        <div
          class="nav-ignia__social nav-ignia__social--header"
          aria-label={socialAriaLabel}
        >
          <a
            href="https://www.linkedin.com/company/ignia-cloud/"
            class="nav-ignia__social-link nav-ignia__social-link--linkedin"
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="sr-only">{socialLabels.linkedin}</span>
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M20.45 20.45h-3.4v-5.34c0-1.27-.02-2.91-1.77-2.91-1.77 0-2.04 1.38-2.04 2.81v5.44h-3.39V9h3.25v1.56h.05c.45-.85 1.56-1.74 3.21-1.74 3.43 0 4.06 2.26 4.06 5.19v6.44ZM5.34 7.43a1.97 1.97 0 1 1 0-3.94 1.97 1.97 0 0 1 0 3.94ZM7.05 20.45H3.62V9h3.43v11.45Z"
                fill="currentColor"></path>
            </svg>
          </a>
          <a
            href="https://wa.me/525569527498"
            class="nav-ignia__social-link nav-ignia__social-link--whatsapp"
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="sr-only">{socialLabels.whatsapp}</span>
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M12 2a9.94 9.94 0 0 0-8.51 15.3L2 22l4.83-1.45A9.94 9.94 0 1 0 12 2Zm0 17.8a7.8 7.8 0 0 1-3.98-1.1l-.28-.17-2.86.86.92-2.77-.18-.29A7.8 7.8 0 1 1 12 19.8Zm4.47-5.55c-.25-.12-1.46-.72-1.68-.8-.22-.08-.38-.12-.54.12-.16.23-.62.77-.76.92-.14.16-.28.18-.53.06-.25-.12-1.06-.39-2.01-1.24-.74-.66-1.24-1.47-1.39-1.72-.15-.26-.02-.4.1-.52.11-.11.25-.28.37-.42.12-.14.16-.23.24-.38.08-.15.04-.29-.02-.41-.06-.12-.54-1.28-.74-1.76-.2-.48-.4-.41-.54-.42h-.46c-.16 0-.41.06-.63.3-.22.23-.83.81-.83 1.98 0 1.17.85 2.3.97 2.46.12.16 1.66 2.53 4.02 3.55.56.24 1 .38 1.34.49.56.18 1.07.15 1.47.09.45-.07 1.46-.6 1.67-1.18.21-.58.21-1.07.15-1.18-.06-.11-.23-.17-.48-.3Z"
                fill="currentColor"></path>
            </svg>
          </a>
        </div>
        <!-- Botón toggle mobile: muestra menú compacto y utilidades en pantallas pequeñas -->
        <button
          id="mobile-menu-button"
          type="button"
          class="inline-flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 text-slate-600 transition hover:border-orange-300 hover:text-orange-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-500 xl:hidden"
          aria-expanded="false"
          aria-controls="mobile-menu"
        >
          <span class="sr-only">{toggleMenuLabel}</span>
          <svg
            class="h-6 w-6"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            data-icon="open"
            aria-hidden="true"
          >
            <path d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg
            class="hidden h-6 w-6"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            data-icon="close"
            aria-hidden="true"
          >
            <path d="M6 6l12 12M18 6l-12 12"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <!-- Menú flyout mobile: alternado mediante botón hamburguesa -->
  <div id="mobile-menu" class="nav-ignia__mobile-menu" hidden>
    <!-- Enlaces de navegación primarios mobile -->
    <nav aria-label={mobileAriaLabel}>
      <ul class="nav-ignia__mobile-list">
        {
          mobileLinks.map((link) => (
            <li>
              <a href={link.href} class="nav-ignia__mobile-link">
                {link.label}
              </a>
            </li>
          ))
        }
      </ul>
    </nav>
    <div class="nav-ignia__mobile-search">
      <SearchBox />
    </div>
    <div class="nav-ignia__mobile-lang">
      <LangSelect />
    </div>
    <div class="nav-ignia__mobile-social" aria-label={socialAriaLabel}>
      <a
        href="https://www.linkedin.com/company/ignia-cloud/"
        class="nav-ignia__social-link nav-ignia__social-link--linkedin"
        target="_blank"
        rel="noopener noreferrer"
      >
        <span class="sr-only">{socialLabels.linkedin}</span>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M20.45 20.45h-3.4v-5.34c0-1.27-.02-2.91-1.77-2.91-1.77 0-2.04 1.38-2.04 2.81v5.44h-3.39V9h3.25v1.56h.05c.45-.85 1.56-1.74 3.21-1.74 3.43 0 4.06 2.26 4.06 5.19v6.44ZM5.34 7.43a1.97 1.97 0 1 1 0-3.94 1.97 1.97 0 0 1 0 3.94ZM7.05 20.45H3.62V9h3.43v11.45Z"
            fill="currentColor"></path>
        </svg>
      </a>
      <a
        href="https://wa.me/525569527498"
        class="nav-ignia__social-link nav-ignia__social-link--whatsapp"
        target="_blank"
        rel="noopener noreferrer"
      >
        <span class="sr-only">{socialLabels.whatsapp}</span>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M12 2a9.94 9.94 0 0 0-8.51 15.3L2 22l4.83-1.45A9.94 9.94 0 1 0 12 2Zm0 17.8a7.8 7.8 0 0 1-3.98-1.1l-.28-.17-2.86.86.92-2.77-.18-.29A7.8 7.8 0 1 1 12 19.8Zm4.47-5.55c-.25-.12-1.46-.72-1.68-.8-.22-.08-.38-.12-.54.12-.16.23-.62.77-.76.92-.14.16-.28.18-.53.06-.25-.12-1.06-.39-2.01-1.24-.74-.66-1.24-1.47-1.39-1.72-.15-.26-.02-.4.1-.52.11-.11.25-.28.37-.42.12-.14.16-.23.24-.38.08-.15.04-.29-.02-.41-.06-.12-.54-1.28-.74-1.76-.2-.48-.4-.41-.54-.42h-.46c-.16 0-.41.06-.63.3-.22.23-.83.81-.83 1.98 0 1.17.85 2.3.97 2.46.12.16 1.66 2.53 4.02 3.55.56.24 1 .38 1.34.49.56.18 1.07.15 1.47.09.45-.07 1.46-.6 1.67-1.18.21-.58.21-1.07.15-1.18-.06-.11-.23-.17-.48-.3Z"
            fill="currentColor"></path>
        </svg>
      </a>
    </div>
</div>
</header>

<!-- 
  Progressive enhancement script: cargado con defer para no bloquear el hilo principal.
  Solo agrega funcionalidad NO ESENCIAL (cerrar menú mobile, keyboard Escape).
  La funcionalidad core (hover, focus) es manejada por CSS puro.
  
  Cumplimiento arquitecture.md §2: "JavaScript debe ser aislado, diferido y sólo en la página que lo requiera"
-->
<script src="../scripts/header-progressive.ts"></script>

