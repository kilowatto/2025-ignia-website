---
/**
 * /fr/contact - Page de contact (Français)
 *
 * CUMPLIMIENTO: PIPELINE_NEW_PAGE.md
 * ✅ 1. Estructura de archivos EN/ES/FR
 * ✅ 2. Traducciones i18n
 * ✅ 3. Componente reutilizable
 * ✅ 4. API routes
 * ✅ 5. Sitemap
 * ✅ 6. Search index
 * ✅ 7. SEO & structured data
 */

import BaseLayout from "../../layouts/BaseLayout.astro";
import ContactPage from "../../components/ContactPage.astro";
import { l, t } from "astro-i18n";
import frTranslations from "../../i18n/fr.json";

const lang = "fr";

// Extract contact translations and flatten to match component usage
const translations: Record<string, string> = {};
const contactData = frTranslations.home.contact;

// Helper to flatten nested object
function flattenObject(obj: any, prefix = '') {
  for (const key in obj) {
    const value = obj[key];
    const newKey = prefix ? `${prefix}.${key}` : key;
    
    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {
      flattenObject(value, newKey);
    } else {
      translations[newKey] = String(value);
    }
  }
}

flattenObject(contactData, 'contact');

// JSON-LD Structured Data for ContactPage
const jsonLdContactPage = {
  "@context": "https://schema.org",
  "@type": "ContactPage",
  name: t("contact.meta.title"),
  description: t("contact.meta.description"),
  url: "https://ignia.cloud/fr/contact",
  inLanguage: "fr",
  mainEntity: {
    "@type": "Organization",
    name: "Ignia Cloud",
    url: "https://ignia.cloud",
    contactPoint: [
      {
        "@type": "ContactPoint",
        contactType: "Sales",
        email: "hola@ignia.la",
        telephone: "+52-55-5555-5555",
        availableLanguage: ["English", "Spanish", "French"],
        areaServed: "Worldwide",
        hoursAvailable: {
          "@type": "OpeningHoursSpecification",
          dayOfWeek: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          opens: "09:00",
          closes: "18:00",
          timeZone: "America/Mexico_City",
        },
      },
      {
        "@type": "ContactPoint",
        contactType: "Emergency Support",
        telephone: "+52-55-5555-5555",
        availableLanguage: ["English", "Spanish", "French"],
        areaServed: "Worldwide",
        hoursAvailable: "24/7",
      },
    ],
  },
};

// OpenGraph metadata
const ogImage = "https://ignia.cloud/Ignia-blanco.png";
---

<BaseLayout
  title={t("contact.meta.title")}
  description={t("contact.meta.description")}
  canonicalUrl="https://ignia.cloud/fr/contact"
  ogImage={ogImage}
  pageType="website"
  structuredData={[jsonLdContactPage]}
>
  <ContactPage lang={lang} translations={translations} />
</BaseLayout>
